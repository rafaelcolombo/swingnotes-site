<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>RelatÃ³rio de Performance - Swing Notes</title>
  <style>
    body {
      background-color: #0c1525;
      color: #ffffff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }

    h2 {
      text-align: center;
      color: #f0c14b;
      margin-bottom: 30px;
    }

    .linha {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      margin-bottom: 20px;
    }

    .bloco {
      background-color: #101e33;
      color: #ffffff;
      border: 1px solid #444;
      border-radius: 10px;
      padding: 15px 20px;
      font-size: 0.9rem;
      box-shadow: 0 0 5px rgba(0,0,0,0.3);
      flex: 1;
      min-width: 250px;
      max-width: 300px;
    }

    .bloco h3 {
      margin-top: 0;
      font-size: 1rem;
      font-weight: 600;
      color: #f0c14b;
    }

    .bloco p {
      margin: 4px 0;
    }

    .observacao {
      font-style: italic;
      font-size: 0.85rem;
      text-align: center;
      margin-top: 20px;
      color: #999;
    }
  </style>
</head>
<body>

  <h2>ðŸ“Š RELATÃ“RIO DE PERFORMANCE</h2>

  <div class="linha"></div> <!-- Linha 1: Conta, Fechados, Abertos -->
  <div class="linha"></div> <!-- Linha 2: PosiÃ§Ã£o Geral, MÃªs Corrente, MÃªs Anterior -->
  <div class="linha"></div> <!-- Linha 3: Drawdown, Sharpe, Expectancy -->
  <div class="linha"></div> <!-- Linha 4: MÃ©tricas por Trade -->

  <script>
    fetch('report.json')
      .then(res => res.json())
      .then(data => {
        const format = (val) => (val > 0 ? '+' : '') + val.toFixed(2);
        const bloco = (titulo, linhas) => {
          const div = document.createElement('div');
          div.className = 'bloco';
          div.innerHTML = `<h3>${titulo}</h3>` + linhas.map(l => `<p>${l}</p>`).join('');
          return div;
        };

        const linha = document.querySelectorAll('.linha');

        linha[0].append(
          bloco('ðŸ’° CONTA', [
            `Total: <strong>US$ ${format(data.Conta.Total)}</strong>`,
            `Alocado: <strong>US$ ${format(data.Conta.Alocado)} (${(data.Conta.Alocado / data.Conta.Total * 100).toFixed(2)}%)</strong>`,
            `Saldo DisponÃ­vel: <strong>US$ ${format(data.Conta.SaldoDisponivel)}</strong>`
          ]),
          bloco('âœ… FECHADOS', [
            `PnL Total: <strong style="color:${data.Fechados.PnLTotal >= 0 ? '#50c878' : '#ff6f61'}">${format(data.Fechados.PnLTotal)} USD</strong>`,
            `PnL %: <strong style="color:${data.Fechados.PnLPercent >= 0 ? '#50c878' : '#ff6f61'}">${format(data.Fechados.PnLPercent)}%</strong>`
          ]),
          bloco('ðŸš€ ABERTOS', [
            `PnL Estimado: <strong>${format(data.Abertos.PnLEstimado)} USD</strong>`,
            `PnL Estimado %: <strong>${format(data.Abertos.PnLEstimadoPercent)}%</strong>`
          ])
        );

        const posicoes = data.PosicaoMensal;
        linha[1].append(
          bloco('ðŸ“ˆ POSIÃ‡ÃƒO GERAL', [
            `PnL Combinado: <strong style="color:${data.PosicaoGeral.PnLCombinado >= 0 ? '#50c878' : '#ff6f61'}">${format(data.PosicaoGeral.PnLCombinado)} USD</strong>`,
            `PnL Combinado %: <strong>${format(data.PosicaoGeral.PnLCombinadoPercent)}%</strong>`
          ]),
          bloco('ðŸ“… POSIÃ‡ÃƒO MÃŠS CORRENTE', [
            posicoes.length > 0 ?
              `${posicoes[posicoes.length - 1].Mes}: <strong>${format(posicoes[posicoes.length - 1].PnL)} USD (${format(posicoes[posicoes.length - 1].PnLPercent)}%)</strong>`
            : `<strong>â€”</strong>`
          ]),
          bloco('ðŸ“… POSIÃ‡ÃƒO MÃŠS ANTERIOR', [
            posicoes.length > 1 ?
              `${posicoes[posicoes.length - 2].Mes}: <strong>${format(posicoes[posicoes.length - 2].PnL)} USD (${format(posicoes[posicoes.length - 2].PnLPercent)}%)</strong>`
            : `<strong>â€”</strong>`
          ])
        );

        linha[2].append(
          bloco('ðŸ”» MAXIMUM DRAWDOWN', [
            `Maior queda: <strong style="color:#ff6f61;">${format(data.MaxDrawdown)}%</strong>`
          ]),
          bloco('ðŸ“ˆ SHARPE RATIO', [
            `Retorno/Risco: <strong>${format(data.SharpeRatio)}</strong>`
          ]),
          bloco('ðŸ§® EXPECTANCY', [
            `Esperado por trade: <strong>${format(data.Expectancy)} USD</strong>`
          ])
        );

        const m = data.MetricasPorTrade;
        linha[3].append(
          bloco('ðŸ“Ž MÃ‰TRICAS POR TRADE', [
            `MÃ©dia PnL: <strong>${format(m.MediaPnL)} USD</strong>`,
            `Retorno sobre Conta: <strong>${format(m.RetornoConta)}%</strong>`,
            `Win Rate: <strong style="color:#50c878;">${format(m.WinRate)}%</strong>`,
            `Maior Lucro: <strong style="color:#50c878;">${format(m.MaiorLucro.Valor)} USD (${format(m.MaiorLucro.Percent)}%)</strong>`,
            `Maior PrejuÃ­zo: <strong style="color:#ff6f61;">${format(m.MaiorPrejuizo.Valor)} USD (${format(m.MaiorPrejuizo.Percent)}%)</strong>`,
            `<em>* ${data.Resumo.TotalTrades} trades desde ${data.Resumo.DataPrimeiroTrade} (${data.Resumo.DiasUteis} dias Ãºteis)</em>`
          ])
        );
      })
      .catch(err => {
        console.error("Erro ao carregar report.json:", err);
        const erro = document.createElement('p');
        erro.textContent = "Erro ao carregar relatÃ³rio.";
        erro.style.textAlign = "center";
        erro.style.color = "#ff6f61";
        document.body.appendChild(erro);
      });
  </script>

</body>
</html>
